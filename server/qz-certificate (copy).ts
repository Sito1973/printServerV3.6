/**
 * Certificado específico para QZ Tray (versión servidor)
 * Esta configuración ayuda a conectar con QZ Tray 2.2.x sin configuración adicional
 */

// Certificado autofirmado para QZ Tray
export const PRIVATE_KEY = `-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC0z5j6aGsHm9y3
JGod6odxQXYpcfU0BEXxF6O8wqr9YXcUcKvx67U2z1vyfnQ7rI5TrV7HvFkKCd+Z
O3B3ThLXQGi6sBfI4MIxrxO/B5KvOqGgwWFOiYU8Y1VBrFft9y4JVESMw9Q8KM9h
j5hfuiP9aTVBdBkfXBSgT1WNUwF7KC5j9W58aQjEI1KBx0kGZnlCqSHrKS6Upf+l
vdKHQNaCJjL8PGZHv48w9SgQ7Va2D+4NmGT+MI8/4wUrbTZs7fKeHcEgLo6qEQd1
MdlxDT9kNFx/5LRt4LNmvl46WKK7nlR1Fgm8/PgY7Za4KMfgUTpSKoO/5Rq2iNfF
k5cM/GcbAgMBAAECggEAVdT80OzwTmI/dNGNUTR/wrV1L8shGjl7q8t5O8vsG/5w
SqJPB+awGYJst0aeEMaJGLwI5jLnVehuKPnH9jGXgGj8hDnBm3g0oBPJ1EIJWrPE
pGQFxOkE2BKnUoyLQuJVyK1+QaoVWSjoDQsxkV2qLu+LO9AcGoGv31VmILVNK3in
WmQYqeK8W13ajzDArsK8uL6EPt/WeTTK5wCJzA2zsJkmxcziCFe/dA6yfgvXNPAt
ys0ByrCbPQcJRXrKa5MQuFQB2mXSXV80OV4hEFwqCsQTDZxoI0QwLZR0nXFb/mQH
z/rpLLBKZqnWnXqPSiRmYGJQGYVtcH9VKpQBgUUF4QKBgQDkkpT83Jf7juDhtXDX
j3xFzOfURlYVBv8AVYZG6c8BilqecFYOxZJqYjzLqumOLkPEjhcINPpA7Kgzo2H4
3Hcl9f7JB7ULGXl4JMEWKeZ1O+A+7/3FOlN2fKHDwSeTfwgXFw9ZMT8A+ZBLLd5W
T5HkCQbUKR4L5ZEY5t/j47ZtOQKBgQDKlHJ7ixgz8mXwN5o09ht4PJdXwBrWnLfq
EwSYnbAaXbxh7pM5FrH/i7V4Nz+ESJRnSL6y+UiV9/JAoaSKX+oExgZt3sAKh0g6
U8XQgVgLLZAcpGiPvv5HzaMomJ2u2nD3wkgCz87aNYl3M7cIJWfFj+9/QirXlw7q
CFvfDf9QAwKBgQCuM9UQYVz/PXTBSI7xS9dpwCAatRUzFLbPQGdyHM0DFk6FoQpW
Nd0yhf4XSiMAwIKYDXnuJNDYJ7tCK4lLqIe3advFKEOJTsXYXQmt4CVX2xdKOaVm
/1/NPd+KrQxCx+61sBL4nBVdj59Udr7zCmMrXCh+Kzv/g4XL2uWbJbqV2QKBgGig
u+b2/YbgTkwTXF0cN3d9Cx75X1ZZPKoVvwkZNRVdTkJvq9YfPaXe5HgpIicSnZDO
s82NTlJWDR7n8UtlA3rYeBQ6kn4RALI0bfP5q3BpfVQs+7wWnF8eNVoGHoSzR6PA
vXKIzY+OmL3xPDDuUU2RL0iZQszMRJHIlAC9gZ5BAoGBAKZIvf5XBlTqd/a9LGWW
ot3SMmLnQyaTAUAXE/VaCeWR7ym9fyCDGKWbCMXxNd/jWwvJSeC/2Dz7BmJAN1VN
t2MxjEAqEEMXHEYt3aami+QgBdxPzDdSJoySjDj2c3uoTE8PKngiNDNkmWqzTbJS
4jP2UtS6X7zHdNGvD8OFlUbU
-----END PRIVATE KEY-----`;

export const DIGITAL_CERTIFICATE = `-----BEGIN CERTIFICATE-----
MIIDiTCCAnGgAwIBAgIUemXHGJVz+Jbd5Bw9D99LF5O+3NwwDQYJKoZIhvcNAQEL
BQAwVDELMAkGA1UEBhMCRVMxDzANBgNVBAgMBk1hZHJpZDEPMA0GA1UEBwwGTWFk
cmlkMQ8wDQYDVQQKDAZQcmludGMxEjAQBgNVBAMMCVByaW50ZXJIdWIwHhcNMjQw
MzA5MDAwMDAwWhcNMjUwMzA5MDAwMDAwWjBUMQswCQYDVQQGEwJFUzEPMA0GA1UE
CAwGTWFkcmlkMQ8wDQYDVQQHDAZNYWRyaWQxDzANBgNVBAoMBlByaW50YzESMBAG
A1UEAwwJUHJpbnRlckh1YjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB
ALTG2W5YLsJ7iuC+b5YG2XxXWjO6PWPG8dFyVhMxqTvhyD+GYL9CcyMpBvL4/8TQ
EXfbrLAGAnRMQEQm5tIEp9+XBrK8KIoKZWahXlYlxSlALNBPZyRJswMlK76LCguv
5AEi3QO0G2nOBjGT/RCZdpSLMhJMxXJSULY7aJsV7QVhcJKYxmLfRJWg2c+a7ELB
QtJpdB5q2x7D38jW7nMIOGgFQUSxF0+rdYfnUX3pRUKu7K8XZ6xDtVbI4FK4/Z1A
mTAxrnfJTIUGp0JeJt5aWYuzLKGQKgcAVtGnSxYkIFQzXxGzspJJtZ57e9wVw7WT
cKrQjO8hRKQSnvC13UQzXDUCAwEAAaNTMFEwHQYDVR0OBBYEFAI9n8hbk0SkF6E7
o81TWlIj5ad/MB8GA1UdIwQYMBaAFAI9n8hbk0SkF6E7o81TWlIj5ad/MA8GA1Ud
EwEB/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAHJZY5c5zOoadwsHfb3hIgGZ
RuZmrHK0TCnG1qf5FyLZc9YDzJTKq6ICGRC+1L4O9eAjGnMPOJkQi1kBUdqh1CuA
tOQ0F0xjcOYs5FZuUPanxChbUw9RQPESzRwZH2nGvzpw9R02Ufi8LQiG1BGF8zNP
TuEzLW6UVWfRXQ3OQdXHr9/rPQE7HPMYQbQHxFJgwUXp/5bUEVrV4GOSZUXjfNQD
XKhsZ0sBZfXTVYGgXOTJiWQwGWN6bnQYQMUQf/X9WqV8dMLmSRIE4A7UkXPUvuGT
RvLQfHr7I2Q8yZzEF/CIC5UAcYiYrBBFXh4xYwjzQjDYZ2WGUo3L0hG5zQxOBSM=
-----END CERTIFICATE-----`;

/**
 * Firma de autor que se usará con la clave privada
 */
interface Signature {
  sign(hash: string): string;
}

/**
 * Configurar QZ Tray con certificado y firma personalizada
 * @param qz Referencia a la biblioteca QZ Tray
 */
export function configureCertificate(qz: any): void {
  try {
    if (!qz) {
      console.error("No se puede configurar el certificado porque QZ Tray no está disponible");
      return;
    }

    console.log("Configurando seguridad mínima para QZ Tray 2.2.x...");

    // OPCIÓN SIN CERTIFICADO: la más básica, 
    // permite conexión sin verificación de certificados (solo para desarrollo local)
    qz.security.setCertificatePromise(function(resolve: any) {
      resolve(null);
    });

    // Firma mínima que permite la conexión en modo inseguro
    qz.security.setSignaturePromise(function(toSign: any) {
      return function(resolve: any) {
        resolve({ 
          signature: "NO_SIGNATURE_REQUIRED", 
          timestamp: Date.now(), 
          signedData: toSign 
        });
      };
    });

    console.log("Seguridad mínima configurada correctamente para QZ Tray 2.2.x");
  } catch (error) {
    console.error("Error al configurar certificado:", error);
  }
}

export default {
  configureCertificate,
  PRIVATE_KEY,
  DIGITAL_CERTIFICATE
};